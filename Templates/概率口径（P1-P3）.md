# 概率/probability 口径（P1-P3）

> [!WARNING] 单一信源原则
> `概率/probability` 字段的**允许值**以 [Templates/属性值预设.md](属性值预设.md) 为准。课程笔记里不要写自由文本/百分比，避免后续统计与巡检口径漂移。

## 1) 允许值（仅这 3 个）
- P1-低 (Low)
- P2-中 (Medium)
- P3-高 (High)

## 2) 使用规范（推荐）
- Frontmatter 只填枚举：`概率/probability: P2-中 (Medium)`
- 具体理由写在正文（而不是属性里），例如在“交易含义/总结”下加一行“概率说明”。

## 3) 快速判定（最小口径）
| 等级 | 直觉含义 | 你至少需要看到 | 典型不满足时降级 |
|---|---|---|---|
| P3-高 (High) | 明显优势 | 脉络顺 + 信号质量高 + 有空间 + 有跟进/确认 | 缺跟进、位置不佳、空间不足 |
| P2-中 (Medium) | 有条件的优势 | 条件满足一部分，仍需确认或容错更小 | 信号一般、脉络冲突、结构不清晰 |
| P1-低 (Low) | 优势不清晰 | 更像均衡/噪音或空间极小 | 铁丝网、重叠严重、追突破/猜反转 |

#flashcards

- 概率/probability 字段允许哪些值？:: 只允许 `P1-低 (Low)`、`P2-中 (Medium)`、`P3-高 (High)` 三个枚举值。
- 为什么不要在概率里写“50%/60%/一段解释”？:: 会造成口径漂移，Inspector/统计无法稳定聚合；解释应该写在正文而不是属性。
- P3-高 (High) 的最小判定条件是什么？:: 脉络顺 + 信号质量高 + 有空间 + 有跟进/确认。
- P1-低 (Low) 常见场景是什么？:: 铁丝网/重叠严重/空间小/结构不清晰，优势不明确。

## 统计（太妃课程）

```dataviewjs
const allowed = new Set(["P1-低 (Low)", "P2-中 (Medium)", "P3-高 (High)"]);

const pages = dv
  .pages('#PA/Course')
  .where(p => p.file.path.startsWith("Categories 分类/太妃价格行为/"));

const counts = new Map();
const invalid = [];
const empty = [];

for (const p of pages) {
  const v = p["概率/probability"];
  const val = (v ?? "").toString().trim();

  if (!val) {
    empty.push(p.file.link);
    continue;
  }

  counts.set(val, (counts.get(val) ?? 0) + 1);
  if (!allowed.has(val)) invalid.push([p.file.link, val]);
}

dv.table(
  ["概率值", "数量"],
  Array.from(counts.entries()).sort((a, b) => a[0].localeCompare(b[0], 'zh-CN'))
);

if (empty.length) {
  dv.header(3, "未填写（空）");
  dv.list(empty);
}

if (invalid.length) {
  dv.header(3, "非法值（不在预设）");
  dv.table(["文件", "当前值"], invalid);
}
```
