# Capability: System Maintainer (ç³»ç»Ÿç»´æŠ¤ä¸“å®¶)

**è§¦å‘æ¡ä»¶**: å½“ç”¨æˆ·è¦æ±‚ "å‡çº§ç³»ç»Ÿ"ã€"ä¿®å¤æ¨¡æ¿"ã€"æ£€æŸ¥æ•°æ®å¥åº·åº¦" æˆ– "æ·»åŠ æ–°å±æ€§" æ—¶ã€‚

## 1. ğŸ›¡ï¸ Template Integrity Check (æ¨¡æ¿å®Œæ•´æ€§æ£€æŸ¥)
**ç›®æ ‡**: ç¡®ä¿æ‰€æœ‰ `Templates/` ä¸‹çš„æ–‡ä»¶éƒ½å¼•ç”¨äº†æœ€æ–°çš„ APIï¼Œä¸”æ²¡æœ‰ç¡¬ç¼–ç é”™è¯¯ã€‚

### æ£€æŸ¥æ¸…å•:
1.  **Scan**: è¯»å– `Templates/å•ç¬”äº¤æ˜“æ¨¡ç‰ˆ (Trade Note).md`ã€‚
2.  **Verify**: æ£€æŸ¥æ˜¯å¦ä½¿ç”¨äº† `utils.safeStr` æˆ– `utils.safeNum`ã€‚å¦‚æœå‘ç°äº† `cur["field"]` è¿™ç§è£¸å†™è®¿é—®ï¼Œ**å¿…é¡»**é‡æ„ä¸ºå®‰å…¨è®¿é—®ã€‚
3.  **Action**: 
    - å¦‚æœå‘ç°æ—§ä»£ç ï¼Œä½¿ç”¨ `sed` æˆ– `replace_file` æ›´æ–°ä»£ç å—ã€‚
    - å‚è€ƒæ ‡å‡†: `utils.safeStr(cur, ["å­—æ®µå", "field_name"])`ã€‚

## 2. ğŸ”„ Core Upgrade Workflow (æ ¸å¿ƒå‡çº§æµ)
**ç›®æ ‡**: å®‰å…¨åœ°å‡çº§ `scripts/` ä¸‹çš„ JS æ¨¡å—ã€‚

### æ­¥éª¤:
1.  **Map Check (Mandatory)**: ä¿®æ”¹å‰å¿…é¡»é˜…è¯» `.serena/memories/Trader_Console_Architecture_Map.md`ï¼Œç¡®è®¤æ¨¡å—å½’å±ã€‚
2.  **Backup**: åœ¨ä¿®æ”¹å‰ï¼Œå…ˆè¯»å–ç›®æ ‡æ–‡ä»¶å†…å®¹å¹¶æš‚å­˜ã€‚
3.  **Atomic Edit**: æ°¸è¿œä¸è¦ä¸€æ¬¡æ€§é‡å†™æ•´ä¸ªæ–‡ä»¶ã€‚ä½¿ç”¨ `replace_file_content` é’ˆå¯¹å…·ä½“å‡½æ•°è¿›è¡Œä¿®æ”¹ã€‚
4.  **Dependency Check**:
    - æ ¸å¿ƒé€»è¾‘ä¸»è¦é›†ä¸­åœ¨ `scripts/pa-core.js` (Monolithic v14.6)ã€‚
    - **æ³¨æ„**: `scripts/core/` ç›®å½•ä¸‹çš„æ–‡ä»¶ç›®å‰å¤„äº"å¼ƒç”¨/å‚è€ƒ"çŠ¶æ€ï¼Œä¸è¦ä¿®æ”¹å®ƒä»¬ï¼Œé™¤éä½ æ‰“ç®—é‡æ–°å‘èµ·æ¶æ„é‡æ„ã€‚
    - ä¿®æ”¹ `scripts/pa-core.js` æ—¶è¦æå…¶å°å¿ƒï¼Œå› ä¸ºå®ƒåŒ…å«äº†æ‰€æœ‰é€»è¾‘ã€‚

## 3. ğŸ§¹ Data Hygiene (æ•°æ®å«ç”Ÿæ¸…æ´—)
**ç›®æ ‡**: æ‰¹é‡ä¿®å¤ Frontmatter æ ¼å¼é”™è¯¯ã€‚

### å¸¸ç”¨è„šæœ¬ (DataviewJS One-Off):
å¦‚æœç”¨æˆ·éœ€è¦æŠŠæ‰€æœ‰ `net_profit: null` æ”¹ä¸º `0`ï¼š
```javascript
// DO NOT RUN AUTOMATICALLY. PROPOSE TO USER FIRST.
const pages = dv.pages("#PA/Trade");
// ... batch update logic ...
```
**æ³¨æ„**: Agent ä¸èƒ½ç›´æ¥ä¿®æ”¹æ–‡ä»¶ç³»ç»Ÿï¼ˆé™¤éé€šè¿‡ `app.vault` æˆ–è€…æ˜¯ tool callï¼‰ã€‚å»ºè®®ç”Ÿæˆè„šæœ¬è®©ç”¨æˆ·åœ¨æ§åˆ¶å°è¿è¡Œï¼Œæˆ–è€…ä½¿ç”¨ `multi_replace_file` è°¨æ…æ“ä½œã€‚

## 4. ğŸš€ Release & Synchronization (å‘å¸ƒä¸åŒæ­¥)
**å®šä¹‰å®Œæˆæ ‡å‡† (Definition of Done)**:
1.  **Manifesto Sync (ç™½çš®ä¹¦åŒæ­¥)**: 
    *   æ£€æŸ¥æœ¬æ¬¡ä¿®æ”¹æ˜¯å¦æ¶‰åŠé€»è¾‘å˜æ›´ã€‚
    *   å¦‚æœæœ‰ï¼Œ**å¿…é¡»ç«‹å³**ç¼–è¾‘ `.serena/memories/Technical_Implementation_Manifesto.md`ã€‚
    *   *Self-Correction*: ä¸è¦ç­‰ä¸‹æ¬¡ï¼Œç°åœ¨å°±æ”¹ã€‚
2.  **Version Bump**: æ›´æ–° `scripts/pa-config.js` ç‰ˆæœ¬å·ã€‚
3.  **Final Report**: åœ¨ `notify_user` ä¸­ï¼Œå¿…é¡»åŒ…å«ä¸€è¡Œï¼š
    *   "âœ… **é€»è¾‘ç™½çš®ä¹¦å·²åŒæ­¥**: æ›´æ–°äº† [æ¨¡å—å] çš„ [å…·ä½“é€»è¾‘] ç« èŠ‚ã€‚"
