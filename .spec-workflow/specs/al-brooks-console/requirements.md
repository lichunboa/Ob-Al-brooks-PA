# Requirements â€” al-brooks-console

## 0. Context
æœ¬ spec ç›®æ ‡æ˜¯æŠŠå½“å‰ Dataview ç‰ˆâ€œäº¤æ˜“å‘˜æŽ§åˆ¶å°â€è¿ç§»ä¸º Obsidian åŽŸç”Ÿæ’ä»¶ï¼ˆReact + TypeScriptï¼‰ï¼Œå¹¶ä»¥çŽ°æœ‰ç³»ç»Ÿä¸ºå¯¹ç…§åŸºå‡†ã€‚

çŽ°çŠ¶å®¡æŸ¥å‚è§ï¼š`ðŸ¦ äº¤æ˜“å‘˜æŽ§åˆ¶å° (Trader Command)/ðŸ“‹ åŽŸç”Ÿæ’ä»¶è¿ç§»-çŽ°çŠ¶å®¡æŸ¥æŠ¥å‘Š.md`

## 0.1 Current Pain Pointsï¼ˆçŽ°ç³»ç»Ÿé—®é¢˜æ¸…å•ï¼‰
- äº¤äº’ï¼šDataviewJS å—é™äºŽ Markdown/DV è¿è¡ŒçŽ¯å¢ƒï¼Œäº¤äº’èƒ½åŠ›ä¸Žä¸€è‡´æ€§ï¼ˆå°¤å…¶ç§»åŠ¨ç«¯ï¼‰ä¸è¶³ã€‚
- åˆ·æ–°ï¼šä¾èµ– Dataview åˆ·æ–°ä¸Žè„šæœ¬åˆ·æ–°é“¾è·¯ï¼Œå®¹æ˜“å‡ºçŽ°â€œçœ‹æ¿ä¸Žæ•°æ®ä¸åŒæ­¥/éœ€è¦æ‰‹åŠ¨åˆ·æ–°â€çš„ä½“éªŒã€‚
- æ€§èƒ½ï¼šå…¨åº“æ‰«æä¸Žé¢‘ç¹é‡ç®—é£Žé™©é«˜ï¼›éœ€è¦æ›´ç¨³å¥çš„å¢žé‡ç´¢å¼•ä¸Žæ‰¹å¤„ç†ã€‚
- å¯ç»´æŠ¤æ€§ï¼šview è„šæœ¬ä¸Žå¤–éƒ¨æ’ä»¶å‘½ä»¤ï¼ˆQuickAdd/SRS ç­‰ï¼‰è€¦åˆï¼Œå‡çº§/ç¼ºå¤±æ—¶é™çº§ç­–ç•¥ä¸ç»Ÿä¸€ã€‚
- å£å¾„ï¼šç»Ÿè®¡å£å¾„å­˜åœ¨æ½œåœ¨ä¸ä¸€è‡´ï¼ˆä¾‹å¦‚èƒœçŽ‡/å‡€åˆ©æ¶¦å­—æ®µä¼˜å…ˆçº§ï¼‰ï¼Œéœ€è¦æ’ä»¶å†…å•ä¸€å£å¾„ã€‚

## 1. Goals
- æä¾›ä¸€ä¸ªåŽŸç”Ÿæ’ä»¶è§†å›¾ï¼ˆItemViewï¼‰ï¼Œä½œä¸ºä»ªè¡¨ç›˜å…¥å£ï¼Œæ›¿ä»£ Dataview æŽ§åˆ¶å°çš„æ ¸å¿ƒçœ‹æ¿èƒ½åŠ›ï¼Œå¹¶èƒ½åœ¨æ¡Œé¢ç«¯ä¸Žç§»åŠ¨ç«¯ä¿æŒå¯ç”¨ã€å¯äº¤äº’ã€‚
- é€šè¿‡ Obsidian åŽŸç”Ÿäº‹ä»¶ä¸Žç´¢å¼•èƒ½åŠ›ï¼Œå®žçŽ°å¯¹äº¤æ˜“ç¬”è®°çš„**å®žæ—¶ç›‘æŽ§ä¸Žå¢žé‡æ›´æ–°**ï¼ˆæ”¹å±žæ€§ã€æ”¹æ­£æ–‡ã€é‡å‘½åã€ç§»åŠ¨è·¯å¾„éƒ½èƒ½è§¦å‘ï¼‰ã€‚
- MVP é˜¶æ®µåªå®žçŽ°ï¼š**ç»Ÿè®¡å¡ç‰‡ + äº¤æ˜“åˆ—è¡¨**ï¼Œå¹¶ä¸Žæ•°æ®ç´¢å¼•ï¼ˆTradeIndexï¼‰å®žæ—¶è”é€šã€‚
- ä¿ç•™ Dataview ç‰ˆä½œä¸ºå¯¹ç…§ä¸Ž fallbackï¼Œç›´åˆ°æ’ä»¶è¾¾åˆ° MVP å¯¹é½æ ‡å‡†ã€‚

## 1.1 Goalsï¼ˆBeyond MVP / é•¿æœŸç›®æ ‡ï¼Œä¸ç­‰äºŽå½“å‰å®žçŽ°æ‰¿è¯ºï¼‰
- æ™ºèƒ½ï¼šåŸºäºŽè¯¾ç¨‹/ç¬”è®°/äº¤æ˜“è®°å½•ä¸‰ç±»æ•°æ®ï¼Œåšè·¨æ¨¡å—çš„å…³è”ä¸ŽæŽ¨èï¼ˆä¾‹å¦‚ä»Žäº¤æ˜“å¼±ç‚¹åæŽ¨å¤ä¹ å†…å®¹ï¼‰ã€‚
- ç®—æ³•ï¼šé€æ­¥å¢žå¼ºâ€œå›¾è¡¨ â†’ ç­–ç•¥æŽ¨èâ€çš„èƒ½åŠ›ï¼ˆä¾‹å¦‚ç»“åˆå½“æ—¥èµ°åŠ¿ä¸ŽåŽ†å²äº¤æ˜“è¡¨çŽ°æŽ¨èç­–ç•¥/è®­ç»ƒé¡¹ï¼‰ã€‚
- äº¤äº’ï¼šæä¾›æ›´é¡ºæ‰‹çš„äº¤äº’é“¾è·¯ï¼ˆä¾‹å¦‚æ›´å¿«çš„æ‰“å¼€/å›žåˆ°çœ‹æ¿/å®šä½äº¤æ˜“ï¼‰ï¼Œå¹¶ä¿æŒæ¡Œé¢ç«¯ä¸Žç§»åŠ¨ç«¯ä¸€è‡´å¯ç”¨ã€‚

## 2. Non-Goals (MVP æš‚ä¸åšï¼Œä½†ä¸ä»£è¡¨æœ€ç»ˆä¸åš)
- å¤æ‚ç­–ç•¥åˆ†ç±»ä¸Žâ€œå›¾è¡¨â†’ç­–ç•¥æŽ¨èâ€ç®—æ³•ï¼šMVP ä¸è¿½æ±‚å®Œæ•´è¿ç§»/å…¨è‡ªåŠ¨æŽ¨èï¼›å…ˆæŠŠæ•°æ®ç´¢å¼•ä¸Žå­—æ®µå¥‘çº¦æ‰“ç‰¢ï¼Œä¿è¯åŽç»­å¯å åŠ ç®—æ³•èƒ½åŠ›ã€‚
- å¯è§†åŒ–å›¾è¡¨åº“ï¼šMVP ä¸å¼•å…¥/ä¾èµ–é‡åž‹ç¬¬ä¸‰æ–¹å›¾è¡¨æ¡†æž¶ï¼›â€œæ¯æ—¥äº¤æ˜“ç€‘å¸ƒæµ/å›¾è¡¨åº“â€ç›¸å…³èƒ½åŠ›ä½œä¸º Next é˜¶æ®µäº¤ä»˜ï¼ˆä»ä»¥ Dataview ç‰ˆä¸ºå¯¹ç…§åŸºå‡†ï¼Œç¡®ä¿ä¸ä¸¢ä½“éªŒï¼‰ã€‚
- å¤ä¹ ç®—æ³•ï¼ˆSR æ‰©å±•ï¼‰ï¼šMVP ä¸å®žçŽ°â€œä»Žå®žæˆ˜/å›žæµ‹/æ¨¡æ‹Ÿä¸­å½’å› å¼±ç‚¹â†’æŽ¨èå¤ä¹ â€çš„ç®—æ³•ï¼›ä½†ä¼šé¢„ç•™å¿…è¦å­—æ®µä¸Žäº‹ä»¶æµï¼Œä¾¿äºŽ Advanced é˜¶æ®µæŽ¥å…¥ã€‚
- QuickAdd è§¦å‘æŒ‰é’®ï¼šMVP ä¸å¼ºç»‘å®šï¼›Next é˜¶æ®µå¯é€šè¿‡ Adapter Pattern åšå¯é€‰é›†æˆï¼ˆç¼ºå¤±åˆ™é™çº§ï¼‰ã€‚
- æ¸…ç† Dataview ä»£ç ä¸Žè„šæœ¬ï¼šä»…åœ¨æ’ä»¶ç¨³å®šå¹¶é€šè¿‡å›žå½’å¯¹ç…§åŽå†åšæ¸…ç†ã€‚

## 3. Users & Primary Use Cases
- ä¸»è¦ç”¨æˆ·ï¼švault ä½œè€…æœ¬äººã€‚
- ä½¿ç”¨åœºæ™¯ï¼šæ‰“å¼€æ’ä»¶è§†å›¾ â†’ ç«‹åˆ»çœ‹åˆ°æœ€æ–°ç»Ÿè®¡ä¸Žæœ€è¿‘äº¤æ˜“åˆ—è¡¨ â†’ ç‚¹å‡»äº¤æ˜“æ‰“å¼€åŽŸç¬”è®°ã€‚

## 4. Definitions / Glossary
- äº¤æ˜“ç¬”è®°ï¼ˆTrade Noteï¼‰ï¼šåŒ…å«äº¤æ˜“è®°å½•çš„ Markdown æ–‡ä»¶ã€‚
- TradeIndexï¼šæ’ä»¶å†…çš„ç´¢å¼•ä¸Žç¼“å­˜å±‚ï¼Œè´Ÿè´£å‘çŽ°/è§£æžäº¤æ˜“ç¬”è®°å¹¶èšåˆç»Ÿè®¡ã€‚
- Canonical Fieldsï¼šæ’ä»¶å†…éƒ¨ç»Ÿä¸€å­—æ®µåï¼ˆä¾‹å¦‚ `pnl`, `ticker`, `outcome`ï¼‰ã€‚

## 5. Functional Requirements

### FR-1 æ’ä»¶è§†å›¾ï¼ˆDashboardï¼‰
- æ’ä»¶åº”æ³¨å†Œä¸€ä¸ªå¯æ‰“å¼€çš„ ItemViewï¼Œæ¸²æŸ“ React ä»ªè¡¨ç›˜ã€‚
- ä»ªè¡¨ç›˜å¿…é¡»åŒ…å«ï¼š
  - ç»Ÿè®¡å¡ç‰‡ï¼ˆè‡³å°‘ï¼šäº¤æ˜“æ¬¡æ•°ã€èƒœçŽ‡ã€å‡€åˆ©æ¶¦ï¼‰
    - ç»Ÿè®¡å¿…é¡»æŒ‰ `account_type` åˆ†å¼€è®¡ç®—ï¼ˆå®žç›˜/æ¨¡æ‹Ÿ/å›žæµ‹ï¼‰ï¼Œå¹¶åŒæ—¶æä¾›ä¸€ä¸ªâ€œæ±‡æ€»â€å£å¾„ï¼ˆAllï¼‰ã€‚
  - äº¤æ˜“åˆ—è¡¨ï¼ˆè‡³å°‘ï¼šæ—¥æœŸã€å“ç§ã€ç›ˆäº/ç»“æžœã€ç‚¹å‡»æ‰“å¼€æ–‡ä»¶ï¼‰

### FR-2 æ•°æ®å¼•æ“Žï¼ˆTradeIndexï¼‰
- ç³»ç»Ÿåº”åœ¨æ’ä»¶å¯ç”¨åŽæž„å»º TradeIndexã€‚
- TradeIndex å¿…é¡»æ”¯æŒï¼š
  - åˆå§‹å…¨é‡ç´¢å¼•ï¼ˆå¯åŠ¨/æ‰“å¼€è§†å›¾æ—¶ï¼‰
  - å¢žé‡æ›´æ–°ï¼ˆç›‘å¬ vault äº‹ä»¶ + metadata cache äº‹ä»¶ï¼‰
  - äº‹ä»¶é€šçŸ¥ UIï¼ˆè®¢é˜…å¼/äº‹ä»¶æ€»çº¿ï¼‰

### FR-3 å®žæ—¶ç›‘æŽ§è¦†ç›–é¢
- ç³»ç»Ÿåº”èƒ½åœ¨ä»¥ä¸‹å˜æ›´åŽæ›´æ–°ç»Ÿè®¡ä¸Žåˆ—è¡¨ï¼š
  - ä¿®æ”¹æ–‡ä»¶å†…å®¹ï¼ˆæ­£æ–‡æˆ– frontmatterï¼‰
  - ä¿®æ”¹æ–‡ä»¶å
  - ä¿®æ”¹æ–‡ä»¶è·¯å¾„ï¼ˆç§»åŠ¨ï¼‰
  - åˆ é™¤æ–‡ä»¶

### FR-4 äº¤æ˜“ç¬”è®°è¯†åˆ«è§„åˆ™ï¼ˆMVPï¼‰
- MVP è¯†åˆ«ç­–ç•¥ï¼šä»¥ tag ä¸ºä¸» + fileClass è¾…åŠ©ã€‚
  - Tagï¼šæŠŠ `PA/Trade` ä¸Ž `#PA/Trade` è§†ä¸ºåŒä¹‰ï¼ˆå½’ä¸€åŒ–åŽåˆ¤æ–­ï¼‰ã€‚
  - FileClassï¼ˆå¯é€‰ï¼‰ï¼šè‹¥ç¬”è®°å¸¦ `fileClass` ä¸”å‘½ä¸­äº¤æ˜“ç±»ï¼ˆä¾‹å¦‚ `PA_Metadata_Schema`ï¼‰ï¼Œä¹Ÿåº”è¯†åˆ«ä¸ºäº¤æ˜“ç¬”è®°ã€‚
  - ç†ç”±ï¼šçŽ°çŠ¶ core ä½¿ç”¨ `dv.pages(#PA/Trade)`ï¼Œä½†ä½ çš„äº¤æ˜“æ¨¡æ¿ä¹Ÿä»¥ frontmatter tags ä¸Ž FileClass ä½œä¸ºâ€œè¯†åˆ«å±žæ€§â€ï¼›ä¿æŒä¸€è‡´å¯å‡å°‘è¿ç§»è¯¯å·®ä¸Žæ¼è¯†åˆ«ã€‚

### FR-5 å­—æ®µæ˜ å°„ï¼ˆåŒè¯­ï¼‰
- MVP è‡³å°‘æ”¯æŒä»¥ä¸‹å­—æ®µçš„åŒè¯­æ˜ å°„ï¼š
  - `pnl` â†â†’ `å‡€åˆ©æ¶¦/net_profit` æˆ– `net_profit`
  - `ticker` â†â†’ `å“ç§/ticker` æˆ– `ticker`
- å¯é€‰ï¼ˆå¦‚æžœçŽ°æœ‰æ•°æ®å¤§é‡ä¾èµ–ï¼‰ï¼š`outcome`, `r`, `setup`, `market_cycle`, `tf`, `dir`

### FR-6 èƒœçŽ‡å£å¾„ï¼ˆç»Ÿä¸€ï¼‰
- æ’ä»¶å¿…é¡»å®šä¹‰å¹¶åœ¨å…¨å±€ä½¿ç”¨å•ä¸€èƒœçŽ‡å£å¾„ï¼š
  - é»˜è®¤ï¼šåŸºäºŽ `pnl`ï¼ˆ>0 ä¸º winï¼Œ<0 ä¸º lossï¼Œ=0 ä¸º scratch/ignore å¯é…ç½®ï¼‰
  - å…œåº•ï¼šå½“ `pnl` ç¼ºå¤±æˆ–ä¸å¯è§£æžæ—¶ï¼Œå¯å›žé€€åˆ° `outcome`ï¼ˆWin/Loss/Scratch/ä¸­æ–‡åŒä¹‰ï¼‰

## 6. Non-Functional Requirements
- æ€§èƒ½ï¼šç´¢å¼•ä¸Žå¢žé‡æ›´æ–°åº”é¿å…å…¨åº“é¢‘ç¹æ‰«æï¼›å¿…é¡» debounce/æ‰¹å¤„ç†ã€‚
- ç¨³å®šæ€§ï¼šä»»ä½•å•ä¸ªç¬”è®°è§£æžå¤±è´¥ä¸åº”å¯¼è‡´æ•´ä¸ªä»ªè¡¨ç›˜å´©æºƒã€‚
- å®‰å…¨ï¼šæœªç»ç¡®è®¤ï¼Œæ’ä»¶ä¸å¾—æ‰¹é‡æ”¹å†™ç”¨æˆ·ç¬”è®°ï¼ˆåªè¯»è§£æžï¼‰ã€‚

## 7. EARS Acceptance Criteria
- AC-1 When ç”¨æˆ·æ‰“å¼€æ’ä»¶ä»ªè¡¨ç›˜ Then è§†å›¾åº”åœ¨å¯æŽ¥å—æ—¶é—´å†…æ˜¾ç¤ºç»Ÿè®¡ä¸Žäº¤æ˜“åˆ—è¡¨ã€‚
- AC-2 When ç”¨æˆ·ä¿®æ”¹ä»»ä¸€äº¤æ˜“ç¬”è®°ï¼ˆæ­£æ–‡æˆ– frontmatterï¼‰Then ä»ªè¡¨ç›˜åº”è‡ªåŠ¨æ›´æ–°ï¼ˆæ— éœ€é‡å¯/æ‰‹åŠ¨åˆ·æ–°ï¼‰ã€‚
- AC-3 When ç”¨æˆ·é‡å‘½åæˆ–ç§»åŠ¨äº¤æ˜“ç¬”è®° Then ä»ªè¡¨ç›˜åº”ä¿æŒè¯¥äº¤æ˜“ä»å¯è¢«è¯†åˆ«ä¸”é“¾æŽ¥å¯æ‰“å¼€ã€‚
- AC-4 When `pnl` å­˜åœ¨ä¸”å¯è§£æž Then èƒœçŽ‡ç»Ÿè®¡å¿…é¡»ä»¥ pnl è§„åˆ™è®¡ç®—ã€‚
- AC-5 When `pnl` ç¼ºå¤±ä½† `outcome` å­˜åœ¨ Then èƒœçŽ‡ç»Ÿè®¡å…è®¸å›žé€€åˆ° outcome è§„åˆ™ã€‚
- AC-6 When Dataview ç‰ˆä¸Žæ’ä»¶ç‰ˆåŒæ—¶å­˜åœ¨ Then æ’ä»¶ MVP æœŸé—´ä¸å¾—ç ´å Dataview ç‰ˆè¿è¡Œã€‚

## 8. Risks & Open Questions
- äº¤æ˜“ç¬”è®°è¯†åˆ«å¦‚æžœåŒæ—¶æ”¯æŒ tag+pathï¼Œå¯èƒ½å‡ºçŽ°é‡å¤è®¡å…¥ï¼Œéœ€è¦å®šä¹‰åŽ»é‡ keyï¼ˆå»ºè®® file pathï¼‰ã€‚
- è§£æž frontmatter çš„å­—æ®µç±»åž‹å¯èƒ½ä¸ä¸€è‡´ï¼ˆæ•°å­—/å­—ç¬¦ä¸²/å¸¦å•ä½ï¼‰ï¼Œéœ€è¦å®‰å…¨è§£æžã€‚
