# Capability: System Maintainer (ç³»ç»Ÿç»´æŠ¤ä¸“å®¶)

**è§¦å‘æ¡ä»¶**: å½“ç”¨æˆ·è¦æ±‚ "å‡çº§ç³»ç»Ÿ"ã€"ä¿®å¤æ¨¡æ¿"ã€"æ£€æŸ¥æ•°æ®å¥åº·åº¦" æˆ– "æ·»åŠ æ–°å±æ€§" æ—¶ã€‚

## 1. ğŸ›¡ï¸ Template Integrity Check (æ¨¡æ¿å®Œæ•´æ€§æ£€æŸ¥)
**ç›®æ ‡**: ç¡®ä¿æ‰€æœ‰ `Templates/` ä¸‹çš„æ–‡ä»¶éƒ½å¼•ç”¨äº†æœ€æ–°çš„ APIï¼Œä¸”æ²¡æœ‰ç¡¬ç¼–ç é”™è¯¯ã€‚

### æ£€æŸ¥æ¸…å•:
1.  **Scan**: è¯»å– `Templates/å•ç¬”äº¤æ˜“æ¨¡ç‰ˆ (Trade Note).md`ã€‚
2.  **Verify**: æ£€æŸ¥æ˜¯å¦ä½¿ç”¨äº† `utils.safeStr` æˆ– `utils.safeNum`ã€‚å¦‚æœå‘ç°äº† `cur["field"]` è¿™ç§è£¸å†™è®¿é—®ï¼Œ**å¿…é¡»**é‡æ„ä¸ºå®‰å…¨è®¿é—®ã€‚
3.  **Action**: 
    - å¦‚æœå‘ç°æ—§ä»£ç ï¼Œä½¿ç”¨ `sed` æˆ– `replace_file` æ›´æ–°ä»£ç å—ã€‚
    - å‚è€ƒæ ‡å‡†: `utils.safeStr(cur, ["å­—æ®µå", "field_name"])`ã€‚

## 2. ğŸ”„ Core Upgrade Workflow (æ ¸å¿ƒå‡çº§æµ)
**ç›®æ ‡**: å®‰å…¨åœ°å‡çº§ `scripts/` ä¸‹çš„ JS æ¨¡å—ã€‚

### æ­¥éª¤:
1.  **Backup**: åœ¨ä¿®æ”¹å‰ï¼Œå…ˆè¯»å–ç›®æ ‡æ–‡ä»¶å†…å®¹å¹¶æš‚å­˜ã€‚
2.  **Atomic Edit**: æ°¸è¿œä¸è¦ä¸€æ¬¡æ€§é‡å†™æ•´ä¸ªæ–‡ä»¶ã€‚ä½¿ç”¨ `replace_file_content` é’ˆå¯¹å…·ä½“å‡½æ•°è¿›è¡Œä¿®æ”¹ã€‚
3.  **Dependency Check**:
    - å¦‚æœä¿®æ”¹äº† `pa-loaders.js` çš„è¿”å›ç»“æ„ï¼Œå¿…é¡»æ£€æŸ¥ `pa-analyzers.js` æ˜¯å¦èƒ½å¤„ç†æ–°ç»“æ„ã€‚
    - è¿è¡Œ `pa-core.js` (æˆ–è€…è®©ç”¨æˆ·åˆ·æ–°) å¹¶æ£€æŸ¥ `window.paData.error`ã€‚

## 3. ğŸ§¹ Data Hygiene (æ•°æ®å«ç”Ÿæ¸…æ´—)
**ç›®æ ‡**: æ‰¹é‡ä¿®å¤ Frontmatter æ ¼å¼é”™è¯¯ã€‚

### å¸¸ç”¨è„šæœ¬ (DataviewJS One-Off):
å¦‚æœç”¨æˆ·éœ€è¦æŠŠæ‰€æœ‰ `net_profit: null` æ”¹ä¸º `0`ï¼š
```javascript
// DO NOT RUN AUTOMATICALLY. PROPOSE TO USER FIRST.
const pages = dv.pages("#PA/Trade");
// ... batch update logic ...
```
**æ³¨æ„**: Agent ä¸èƒ½ç›´æ¥ä¿®æ”¹æ–‡ä»¶ç³»ç»Ÿï¼ˆé™¤éé€šè¿‡ `app.vault` æˆ–è€…æ˜¯ tool callï¼‰ã€‚å»ºè®®ç”Ÿæˆè„šæœ¬è®©ç”¨æˆ·åœ¨æ§åˆ¶å°è¿è¡Œï¼Œæˆ–è€…ä½¿ç”¨ `multi_replace_file` è°¨æ…æ“ä½œã€‚

## 4. ğŸ“ Post-Maintenance
- æ›´æ–° `memory/system_evolution.md`ï¼Œè®°å½•æœ¬æ¬¡ç»´æŠ¤é‡åˆ°çš„æ–°æƒ…å†µã€‚
- æ›´æ–° `scripts/pa-config.js` é‡Œçš„ç‰ˆæœ¬å·ã€‚
