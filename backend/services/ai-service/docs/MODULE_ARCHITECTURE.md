# Telegram AI Service æ¨¡å—æž¶æž„æ–‡æ¡£

> ç”Ÿæˆæ—¶é—´: 2025-11-30
> æ¨¡å—ä½ç½®: services/telegram-service/src/ai/src/
> ä»£ç æ€»è¡Œæ•°: ~18,000è¡Œ

## ä¸€ã€æ•´ä½“æž¶æž„åˆ†å±‚

```
â”Œâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”
â”‚                    AI TELEGRAM SERVICE                            â”‚
â”‚                (äº¤æ˜“çŒ« AI äº¤æ˜“åˆ†æžç³»ç»Ÿ)                            â”‚
â””â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¤â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¤â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”˜
                â”‚                               â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                â”‚            â”‚                  â”‚
        â–¼                â–¼            â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   BOT å±‚     â”‚  â”‚   AI å±‚    â”‚  â”‚  DATA å±‚   â”‚  â”‚  UTILS å±‚   â”‚
â”‚  (äº¤äº’å…¥å£)  â”‚  â”‚ (åˆ†æžå¼•æ“Ž) â”‚  â”‚ (æ•°æ®ç®¡ç†) â”‚  â”‚  (å·¥å…·åº“)   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                â”‚               â”‚                â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  PROMPT å±‚    â”‚
                        â”‚ (æç¤ºè¯ç®¡ç†)  â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è°ƒç”¨æ·±åº¦: 10-15å±‚
æ¨¡å—æ•°é‡: 5å¤§å±‚ + 47ä¸ªæ ¸å¿ƒç±»
```

---

## äºŒã€BOT å±‚ (äº¤äº’å…¥å£)

**æ–‡ä»¶**: `bot/bot.py` (38KB)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AITelegramHandler                      â”‚
â”‚                   (Telegramäº¤äº’å¤„ç†å™¨)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚              â”‚              â”‚
        â–¼              â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  text_messageâ”‚â”‚ handle_... â”‚â”‚ refresh_... â”‚
â”‚  (æ¶ˆæ¯å¤„ç†)  â”‚â”‚ (ä¼šè¯ç®¡ç†) â”‚â”‚ (ç¼“å­˜åˆ·æ–°)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ ¸å¿ƒåŠŸèƒ½:
1. æ¶ˆæ¯è·¯ç”± (ç”¨æˆ·è¾“å…¥ â†’ å‘½ä»¤åˆ†å‘)
2. ä¼šè¯ç®¡ç† (ç»´æŠ¤åˆ†æžä¸Šä¸‹æ–‡)
3. è¿›åº¦åé¦ˆ (å®žæ—¶è¿›åº¦æ¡å±•ç¤º)
4. ç»“æžœå±•ç¤º (æ–‡æœ¬/å›¾ç‰‡å‘é€)
```

**æ•°æ®æµ**:
```
ç”¨æˆ·æ¶ˆæ¯: BTC@15m
    â†“
text_message()                      [bot.py:40]
    â†“
_ensure_ai_handler()                [bot.py:32]
    â†“
AITelegramHandler.query()           [ai.py:14003]
    â†“
[è°ƒç”¨AIå±‚åˆ†æž]
    â†“
å‘é€ç»“æžœ (æ–‡å­—/å›¾ç‰‡)                [bot.py:56]
```

---

## ä¸‰ã€AI å±‚ (æ ¸å¿ƒä¸šåŠ¡é€»è¾‘)

**æ–‡ä»¶**: `ai/ai.py` (744KB)

### 3.1 æ ¸å¿ƒç±»ç»“æž„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AITelegramHandler                        â”‚
â”‚                   (Telegramäº¤äº’ä¸»å…¥å£)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚            â”‚            â”‚
            â–¼            â–¼            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚AICoinQueryManagerâ”‚â”‚MultiTime-â”‚â”‚AIAnalysisEngineâ”‚
â”‚ (å¸ç§æŸ¥è¯¢ç®¡ç†)   â”‚â”‚frameCalc â”‚â”‚ (AIåˆ†æžå¼•æ“Ž)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ (å¤šå‘¨æœŸ) â”‚ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â”‚
          â”‚              â”‚              â”‚
          â–¼              â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Technical        â”‚â”‚Data      â”‚â”‚AnalysisReportâ”‚
â”‚IndicatorCalculatorâ”‚â”‚Processingâ”‚â”‚Generator    â”‚
â”‚ (æŠ€æœ¯æŒ‡æ ‡è®¡ç®—)  â”‚â”‚Pipeline  â”‚â”‚ (æŠ¥å‘Šç”Ÿæˆ)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 æ•°æ®ç®¡é“æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              AI åˆ†æžä¸»ç®¡é“ (AI Analysis Pipeline)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                  â”‚                  â”‚
  â–¼                  â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ç”¨æˆ·è¯·æ±‚  â”‚  â”‚ æ•°æ®èŽ·å– â”‚      â”‚  æŒ‡æ ‡è®¡ç®—   â”‚
â”‚BTC@15m   â”‚â”€â”€â–¶â”‚Kçº¿/è®¢å•ç°¿â”‚â”€â”€â”€â”€â”€â–¶â”‚MACD/RSI/KDJâ”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
     â”‚             â”‚                   â”‚
     â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                       â”‚
     â–¼                       â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  AIåˆ†æž      â”‚      â”‚  æŠ¥å‘Šç”Ÿæˆ   â”‚
  â”‚  LLM API     â”‚      â”‚  Markdown   â”‚
  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
         â”‚                     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  å›¾ç‰‡æ¸²æŸ“       â”‚
          â”‚  Playwright     â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  Telegramå‘é€   â”‚
          â”‚  æ–‡å­— + å›¾ç‰‡    â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¤„ç†æ—¶é—´: 15-30ç§’
å¹¶å‘é™åˆ¶: 5ä¸ªAIè¯·æ±‚
```

### 3.3 æ ¸å¿ƒç±»è¯¦è§£

#### AICacheManager (34)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           AICacheManager               â”‚
â”‚        (AIç»“æžœç¼“å­˜ç®¡ç†å™¨)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ L1: å†…å­˜ç¼“å­˜ (60ç§’)                    â”‚
â”‚ L2: Redisç¼“å­˜ (5åˆ†é’Ÿ)                  â”‚
â”‚ L3: SQLiteç¼“å­˜ (24å°æ—¶)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ get() / put() / invalidate()
                   â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  ç¼“å­˜Keyç”Ÿæˆ     â”‚
          â”‚  {symbol}_{type}â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### TechnicalIndicatorCalculator (944)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    TechnicalIndicatorCalculator        â”‚
â”‚      (æŠ€æœ¯æŒ‡æ ‡é›†ä¸­è®¡ç®—å™¨)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è¾“å…¥: DataFrame â”‚  è¾“å‡º: æŒ‡æ ‡ + ä¿¡å·    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                    â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
    â”‚  MA      â”‚        â”‚  MACD      â”‚
    â”‚  RSI     â”‚        â”‚  KDJ       â”‚
    â”‚  ATR     â”‚        â”‚  BB        â”‚
    â”‚  VWAP    â”‚        â”‚  ...       â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ ThreadPoolExecutor  â”‚
        â”‚ max_workers=8       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   æ‰¹é‡è®¡ç®—ç»“æžœ       â”‚
        â”‚   DataFrameè¾“å‡º      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ”¯æŒæŒ‡æ ‡: MA, MACD, RSI, KDJ, ATR, BB, VWAPç­‰20+
```

#### MultiTimeframeCalculator (2340)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      MultiTimeframeCalculator          â”‚
â”‚        (å¤šå‘¨æœŸå…±æŒ¯è®¡ç®—å™¨)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  å‘¨æœŸæƒé‡åˆ†é…    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚         â”‚         â”‚
       â–¼         â–¼         â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ 5m:20% â”‚ â”‚15m:30â”‚ â”‚ 1h:30% â”‚
   â”‚ çŸ­æœŸ   â”‚ â”‚ä¸­æœŸä¸»â”‚ â”‚ ä¸­æœŸä¸» â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
        â”‚        â”‚         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  å…±æŒ¯ä¿¡å·ç”Ÿæˆ    â”‚
        â”‚  å¤šå‘¨æœŸåŠ æƒè®¡ç®—  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ å¤šå¤´/ç©ºå¤´/è§‚æœ›   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å››ã€DATA å±‚ (æ•°æ®ç®¡ç†)

**æ–‡ä»¶**: `data/data.py` (444KB)

### 4.1 æ•°æ®é‡‡é›†æž¶æž„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 æ•°æ®æµæž¶æž„                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                            â”‚
         â–¼                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Binance API      â”‚        â”‚ æœ¬åœ°æ–‡ä»¶/DB      â”‚
â”‚ (å®žæ—¶æ•°æ®)       â”‚        â”‚ (åŽ†å²æ•°æ®)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                           â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ BinanceMarketDataManagerâ”‚
        â”‚ (å¸‚åœºæ•°æ®ç»Ÿä¸€ç®¡ç†)      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚          â”‚          â”‚
        â–¼          â–¼          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Kçº¿æ•°æ®â”‚ â”‚ è®¢å•ç°¿ â”‚ â”‚ èµ„é‡‘è´¹çŽ‡ â”‚
   â”‚ OHLCV  â”‚ â”‚ æ·±åº¦   â”‚ â”‚ Funding  â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
        â”‚         â”‚           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ UnifiedDataSaver     â”‚
        â”‚ (ç»Ÿä¸€å­˜å‚¨å±‚)         â”‚
        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚        â”‚        â”‚        â”‚
      â–¼        â–¼        â–¼        â–¼
   â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”
   â”‚ CSV â”‚ â”‚SQLiteâ”‚ â”‚Time- â”‚ â”‚ S3  â”‚
   â”‚     â”‚ â”‚      â”‚ â”‚scale â”‚ â”‚     â”‚
   â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜
```

### 4.2 æ•°æ®å­˜å‚¨ç­–ç•¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            å¤šçº§å­˜å‚¨ç­–ç•¥                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å­˜å‚¨ç±»åž‹ â”‚  ç”¨é€”      â”‚ æ›´æ–°é¢‘çŽ‡ â”‚  ä¿ç•™æœŸé™    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å†…å­˜ç¼“å­˜ â”‚ å®žæ—¶æŸ¥è¯¢   â”‚ å®žæ—¶     â”‚ 60ç§’         â”‚
â”‚ Redis    â”‚ å¿«é€Ÿè®¿é—®   â”‚ å®žæ—¶     â”‚ 5åˆ†é’Ÿ        â”‚
â”‚ SQLite   â”‚ æœ¬åœ°åˆ†æž   â”‚ 1åˆ†é’Ÿ    â”‚ 24å°æ—¶       â”‚
â”‚ Timescaleâ”‚ æ—¶åºåˆ†æž   â”‚ 1åˆ†é’Ÿ    â”‚ 1000æ ¹Kçº¿    â”‚
â”‚ CSV      â”‚ å¤‡ä»½/å¯¼å‡º  â”‚ 1åˆ†é’Ÿ    â”‚ é•¿æœŸ         â”‚
â”‚ S3       â”‚ ç¾éš¾æ¢å¤   â”‚ æ¯å°æ—¶   â”‚ 30å¤©         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## äº”ã€UTILS å±‚ (å·¥å…·åº“)

**æ–‡ä»¶**: `utils/utils.py` (47KB)

### 5.1 è¿›åº¦æ˜¾ç¤ºç³»ç»Ÿ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ProgressDisplay (è¿›åº¦æ˜¾ç¤º)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é˜¶æ®µ            â”‚  æè¿°                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 10%              â”‚ ðŸ” åˆå§‹åŒ–åˆ†æžå¼•æ“Ž            â”‚
â”‚ 20%              â”‚ ðŸ“Š èŽ·å–å¸‚åœºæ•°æ®              â”‚
â”‚ 35%              â”‚ ðŸ§® è®¡ç®—æŠ€æœ¯æŒ‡æ ‡              â”‚
â”‚ 50%              â”‚ ðŸ¤– å¯åŠ¨AIä¸­                  â”‚
â”‚ 65%              â”‚ ðŸŽ¯ å¤šç»´åº¦åˆ†æžä¸­              â”‚
â”‚ 80%              â”‚ ðŸ§  AIæ·±åº¦å­¦ä¹                 â”‚
â”‚ 95%              â”‚ ðŸ“ˆ ç”Ÿæˆåˆ†æžæŠ¥å‘Š              â”‚
â”‚ 99%              â”‚ ðŸŽ¯ AIååŒåˆ†æžä¸­              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç‰¹è‰²åŠŸèƒ½:
- åŠ¨æ€è¿›åº¦æ¡ (0-100%)
- äº¤æ˜“å°çŸ¥è¯†è½®æ’­ (æ¯7ç§’æ›´æ–°)
- AI AgentçŠ¶æ€æ˜¾ç¤º
- å·²ç”¨æ—¶é—´è®¡ç®—
```

### 5.2 Markdownå›¾ç‰‡æ¸²æŸ“

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    MarkdownImageRenderer (Markdownè½¬å›¾ç‰‡)      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è¾“å…¥            â”‚  è¾“å‡º                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Markdownæ–‡æœ¬     â”‚  PNGå›¾ç‰‡ (1920x1080)         â”‚
â”‚ æŠ€æœ¯æ ˆ:          â”‚  æ ·å¼ç‰¹è‰²:                   â”‚
â”‚  - Playwright    â”‚  - æ¶¨è·Œé¢œè‰² (çº¢/ç»¿)          â”‚
â”‚  - Chromium      â”‚  - ç½®ä¿¡åº¦æ ‡è¯† (é«˜/ä¸­/ä½Ž)     â”‚
â”‚  - markdown lib  â”‚  - è¡¨æ ¼ä¼˜åŒ–                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ¸²æŸ“æµç¨‹:
Markdown â†’ HTMLé¢„å¤„ç† â†’ CSSæ ·å¼ â†’ Playwrightæˆªå›¾ â†’ PNG
```

---

## å…­ã€PROMPT å±‚ (æç¤ºè¯ç®¡ç†)

**æ–‡ä»¶**: `prompt_registry.py`

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          PromptRegistry (æç¤ºè¯æ³¨å†Œè¡¨)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  åŠŸèƒ½            â”‚  å®žçŽ°æ–¹å¼                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ åŠ è½½æç¤ºè¯       â”‚ æ‰«æprompts/ç›®å½•ä¸‹.txtæ–‡ä»¶   â”‚
â”‚ ç¼“å­˜ç®¡ç†         â”‚ å†…å®¹ + æ–‡ä»¶mtime             â”‚
â”‚ çƒ­é‡è½½           â”‚ è¿è¡Œæ—¶æ›´æ–° (changed_only)    â”‚
â”‚ åˆ†ç±»ç®¡ç†         â”‚ system/ analysis/ cards/     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç›®å½•ç»“æž„:
prompts/
â”œâ”€â”€ system/          # ç³»ç»Ÿæç¤ºè¯ (è§’è‰²å®šä¹‰)
â”œâ”€â”€ analysis/        # åˆ†æžæç¤ºè¯ (æŠ€æœ¯é¢/åŸºæœ¬é¢)
â””â”€â”€ cards/           # å¡ç‰‡æç¤ºè¯ (æŽ’è¡Œæ¦œ/ä¿¡å·)
```

---

## ä¸ƒã€å®Œæ•´è°ƒç”¨é“¾ç¤ºä¾‹

### åœºæ™¯: ç”¨æˆ·å‘é€ "BTC@15m"

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              è°ƒç”¨é“¾æ·±åº¦: 10-15å±‚                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
  1. bot.py:text_message()                           [40]
     â””â”€ç”¨æˆ·è¾“å…¥: BTC@

  2. _ensure_ai_handler()                            [32]
     â””â”€åˆå§‹åŒ–AIå¤„ç†å™¨

  3. AITelegramHandler.handle_coin_selection()       [14003]
     â””â”€è¯†åˆ«å¸ç§: BTCUSDT

  4. AICoinQueryManager.query()                      [12089]
     â””â”€ç»Ÿä¸€æŸ¥è¯¢å…¥å£

  5. _build_analysis_data()                          [12248]
     â””â”€æž„å»ºåˆ†æžæ•°æ®

  6. TechnicalIndicatorCalculator.calculate_all()    [944]
     â””â”€è®¡ç®—æŠ€æœ¯æŒ‡æ ‡ (MA/MACD/RSI/KDJ...)

  7. MultiTimeframeCalculator.analyze()              [2340]
     â””â”€å¤šå‘¨æœŸå…±æŒ¯åˆ†æž (5m/15m/1h/4h)

  8. AIAnalysisEngine.generate_analysis()            [5080]
     â””â”€è°ƒç”¨LLM API (Gemini/GPT)

  9. AnalysisReportGenerator.create_report()         [5744]
     â””â”€ç”ŸæˆMarkdownæŠ¥å‘Š

  10. MarkdownImageRenderer.render_markdown_to_image() [878]
      â””â”€æ¸²æŸ“PNGå›¾ç‰‡ (Playwright)

  11. AITelegramHandler.send_results()               [14602]
      â””â”€å‘é€Telegramæ¶ˆæ¯

æ€»è€—æ—¶: 15-30ç§’
å¹¶å‘æŽ§åˆ¶: asyncio.Semaphore(5)
```

---

## å…«ã€æ•°æ®ç®¡é“å…¨æ™¯å›¾

### 8.1 ä¸»æ•°æ®ç®¡é“

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ä¸»AIåˆ†æžç®¡é“ (Main AI Pipeline)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                  â”‚                  â”‚
    â–¼                  â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ç”¨æˆ·è¯·æ±‚ â”‚      â”‚ æ•°æ®èŽ·å–  â”‚      â”‚  æŒ‡æ ‡è®¡ç®—   â”‚
â”‚BTC@15m  â”‚â”€â”€â”€â”€â”€â–¶â”‚Kçº¿+è®¢å•ç°¿ â”‚â”€â”€â”€â”€â”€â–¶â”‚MACD/RSI/KDJ â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
     â”‚                â”‚                   â”‚
     â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                         â”‚
     â–¼                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AIåˆ†æž   â”‚          â”‚  æŠ¥å‘Šç”Ÿæˆ    â”‚
â”‚ LLM API  â”‚          â”‚  Markdown    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                       â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  å›¾ç‰‡æ¸²æŸ“ (PNG)     â”‚
      â”‚  Playwright+Chromiumâ”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ Telegramå‘é€        â”‚
      â”‚ æ–‡å­— + å›¾ç‰‡         â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å“åº”æ—¶é—´: 15-30ç§’
å¹¶å‘é™åˆ¶: 5ä¸ªAIè¯·æ±‚
```

### 8.2 æŠ€æœ¯æŒ‡æ ‡è®¡ç®—ç®¡é“

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æŠ€æœ¯æŒ‡æ ‡æ‰¹é‡è®¡ç®—ç®¡é“                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                  â”‚                  â”‚
  â–¼                  â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MA    â”‚      â”‚ MACD   â”‚      â”‚  RSI   â”‚
â”‚ (å‡çº¿) â”‚      â”‚(è¶‹åŠ¿)  â”‚      â”‚(åŠ¨é‡)  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜      â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚              â”‚               â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  ä¿¡å·ç”Ÿæˆ           â”‚
        â”‚  - è¶…ä¹°è¶…å–         â”‚
        â”‚  - é‡‘å‰æ­»å‰         â”‚
        â”‚  - èƒŒç¦»æ£€æµ‹         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  è¾“å‡º: æ•°å€¼ + ä¿¡å·  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æŠ€æœ¯ç‰¹ç‚¹:
- ThreadPoolExecutor (8çº¿ç¨‹)
- å‘é‡åŒ–è¿ç®— (Pandas)
- æ‰¹é‡è®¡ç®— (å•æ¬¡IO)
- SQLiteç¼“å­˜ (24å°æ—¶)
```

### 8.3 å¤šå‘¨æœŸå…±æŒ¯ç®¡é“

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          å¤šå‘¨æœŸå…±æŒ¯åˆ†æžç®¡é“                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚     è‡ªåŠ¨é€‰æ‹©å…³è”å‘¨æœŸ     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚             â”‚              â”‚
       â–¼             â–¼              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”
   â”‚ 5m   â”‚      â”‚ 15m  â”‚      â”‚ 1h   â”‚
   â”‚ 20%  â”‚      â”‚ 30%  â”‚      â”‚ 30%  â”‚
   â”‚çŸ­æœŸ  â”‚      â”‚ä¸­æœŸä¸»â”‚      â”‚ä¸­æœŸä¸»â”‚
   â””â”€â”¬â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”¬â”€â”€â”˜      â””â”€â”€â”€â”¬â”€â”€â”˜
     â”‚               â”‚             â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   æƒé‡åˆ†é…ä¸Žåˆæˆ     â”‚
        â”‚   - ä¸­æœŸè¶‹åŠ¿ä¼˜å…ˆ     â”‚
        â”‚   - çŸ­æœŸæŠ“å…¥åœº       â”‚
        â”‚   - é•¿æœŸçœ‹å¤§æ–¹å‘     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  å…±æŒ¯ä¿¡å·            â”‚
        â”‚  å¤šå¤´/ç©ºå¤´/è§‚æœ›      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æƒé‡é…ç½®:
5m:20% + 15m:30% + 1h:30% + 4h:15% + 1d:5% = 100%
```

### 8.4 æ•°æ®å­˜å‚¨ç®¡é“

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             æ•°æ®å­˜å‚¨ç®¡é“                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚     æ•°æ®é‡‡é›†ä¸Žæ¸…æ´—       â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ UnifiedDataSaver       â”‚
        â”‚ (ç»Ÿä¸€å­˜å‚¨è°ƒåº¦)         â”‚
        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚         â”‚          â”‚         â”‚          â”‚
   â–¼         â–¼          â–¼         â–¼          â–¼
â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”
â”‚ CSV â”‚ â”‚SQLiteâ”‚ â”‚Time-   â”‚ â”‚ S3  â”‚
â”‚     â”‚ â”‚      â”‚ â”‚scaleDB â”‚ â”‚     â”‚
â””â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”˜
  â”‚        â”‚         â”‚          â”‚
  â”‚        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
  â”‚             â”‚    â”‚    â”‚
  â–¼             â–¼    â”‚    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ äººå·¥æŸ¥é˜… â”‚  â”‚æœ¬åœ°æŸ¥è¯¢ â”‚  â”‚äº‘ç«¯å¤‡ä»½ â”‚
â”‚ å¤‡ä»½å¯¼å‡º â”‚  â”‚å¿«é€Ÿåˆ†æž â”‚  â”‚ç¾éš¾æ¢å¤ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä¹ã€å…³é”®æ€§èƒ½æŒ‡æ ‡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           æ€§èƒ½ç›‘æŽ§æŒ‡æ ‡                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æŒ‡æ ‡     â”‚ ç›®æ ‡å€¼           â”‚ å‘Šè­¦é˜ˆå€¼         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ AIæˆåŠŸçŽ‡ â”‚ >95%             â”‚ <90%             â”‚
â”‚ å“åº”æ—¶é—´ â”‚ 15-30ç§’          â”‚ >60ç§’            â”‚
â”‚ ç¼“å­˜å‘½ä¸­çŽ‡â”‚ >70%            â”‚ <50%             â”‚
â”‚ æ•°æ®å®Œæ•´æ€§â”‚ 99.9%            â”‚ <99%             â”‚
â”‚ å¹¶å‘é™åˆ¶ â”‚ æœ€å¤š5ä¸ªAIè¯·æ±‚    â”‚ è¾¾åˆ°ä¸Šé™         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## åã€ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: å¿«é€ŸAIåˆ†æž

```python
from ai.src.ai import AICoinQueryManager

# åˆ›å»ºæŸ¥è¯¢ç®¡ç†å™¨
manager = AICoinQueryManager()

# æ‰§è¡ŒAIåˆ†æž
result = await manager.query(
    symbol="BTCUSDT",
    interval="15m",
    analysis_type="fast"
)

print(f"ä¿¡å·: {result.signal}")
print(f"ä¿¡å¿ƒåº¦: {result.confidence}%")
print(f"åˆ†æžæŠ¥å‘Š: {result.summary}")
```

### ç¤ºä¾‹2: æ‰¹é‡è®¡ç®—æŠ€æœ¯æŒ‡æ ‡

```python
from ai.src.ai import create_technical_indicator_calculator

# åˆ›å»ºè®¡ç®—å™¨
calculator = create_technical_indicator_calculator()

# æ‰¹é‡è®¡ç®—
df = calculator.calculate_all(
    symbol="BTCUSDT",
    interval="1m",
    indicators=["MACD", "RSI", "KDJ", "ATR"]
)

print(df.head())
```

### ç¤ºä¾‹3: ç”Ÿæˆåˆ†æžæŠ¥å‘Šå›¾ç‰‡

```python
from ai.src.utils.utils import render_ai_analysis_to_image

# æ¸²æŸ“AIåˆ†æžä¸ºå›¾ç‰‡
image_path = await render_ai_analysis_to_image(
    ai_analysis_text=analysis_report,
    symbol="BTCUSDT",
    timeframe="15m"
)

print(f"æŠ¥å‘Šå›¾ç‰‡: {image_path}")
```

---

## åä¸€ã€æ‰©å±•æŒ‡å—

### æ–°å¢žæ•°æ®æº

```python
# 1. åˆ›å»ºæ”¶é›†å™¨
class NewExchangeCollector:
    async def fetch_kline(self, symbol, interval):
        # APIè°ƒç”¨é€»è¾‘
        return data

# 2. æ³¨å†Œåˆ°å·¥åŽ‚
DATA_COLLECTORS = {
    'binance': BinanceCollector,
    'new': NewExchangeCollector,
}

# 3. é…ç½®çŽ¯å¢ƒå˜é‡
EXCHANGE=new
```

### æ–°å¢žæŠ€æœ¯æŒ‡æ ‡

```python
# åœ¨ TechnicalIndicatorCalculator ä¸­æ·»åŠ 

def calc_new_indicator(self, df, param=20):
    # è®¡ç®—é€»è¾‘
    return signal, value

# æ³¨å†Œåˆ° ALL_INDICATORS
ALL_INDICATORS = {
    'new': self.calc_new_indicator,
}
```

---

## åäºŒã€æ•…éšœæŽ’æŸ¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              å¸¸è§é—®é¢˜ä¸Žè§£å†³æ–¹æ¡ˆ                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é—®é¢˜            â”‚ åŽŸå›             â”‚ è§£å†³æ–¹æ¡ˆ         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ AIåˆ†æžè¶…æ—¶      â”‚ LLM APIå“åº”æ…¢   â”‚ å¢žåŠ è¶…æ—¶60ç§’     â”‚
â”‚ æ•°æ®ç¼ºå¤±        â”‚ é‡‡é›†å¤±è´¥        â”‚ è¿è¡Œè¡¥å…¨è„šæœ¬     â”‚
â”‚ ç¼“å­˜æœªå‘½ä¸­      â”‚ TTLè¿‡çŸ­         â”‚ è°ƒæ•´ç¼“å­˜ç­–ç•¥     â”‚
â”‚ å†…å­˜æ³„æ¼        â”‚ è¿žæŽ¥æœªé‡Šæ”¾      â”‚ æ£€æŸ¥async/await  â”‚
â”‚ å¹¶å‘è¶…é™        â”‚ APIé™åˆ¶         â”‚ è°ƒæ•´semaphore    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## é™„å½•

### æ¨¡å—æ¸…å•

```
services/telegram-service/src/ai/src/
â”œâ”€â”€ __init__.py                    (æ¨¡å—åˆå§‹åŒ–)
â”œâ”€â”€ prompt_registry.py             (æç¤ºè¯ç®¡ç†)
â”œâ”€â”€ bot/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ bot.py                     (Telegramæœºå™¨äºº: 38KB)
â”œâ”€â”€ ai/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ ai.py                      (AIæ ¸å¿ƒå¼•æ“Ž: 744KB)
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ data.py                    (æ•°æ®ç®¡ç†: 444KB)
â””â”€â”€ utils/
    â”œâ”€â”€ __init__.py
    â””â”€â”€ utils.py                   (å·¥å…·åº“: 47KB)

ç»Ÿè®¡:
- æ€»ä»£ç è¡Œæ•°: ~18,000è¡Œ
- æ ¸å¿ƒç±»æ•°é‡: 47ä¸ª
- æ¨¡å—æ·±åº¦: 5å±‚
- è°ƒç”¨æ·±åº¦: 10-15å±‚
```
